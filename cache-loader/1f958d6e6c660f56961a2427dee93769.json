{"remainingRequest":"D:\\showU\\GGMS\\node_modules\\babel-loader\\lib\\index.js!D:\\showU\\GGMS\\src\\store\\modules\\user.js","dependencies":[{"path":"D:\\showU\\GGMS\\src\\store\\modules\\user.js","mtime":1533280207830},{"path":"D:\\showU\\GGMS\\.babelrc","mtime":1532942817774},{"path":"D:\\showU\\GGMS\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1533288711758},{"path":"D:\\showU\\GGMS\\node_modules\\babel-loader\\lib\\index.js","mtime":1530808242000}],"contextDependencies":[],"result":["import _Promise from 'babel-runtime/core-js/promise';\nimport { loginByUsername, logout, getUserInfo } from 'api/login';\nimport { getToken, setToken, removeToken } from 'assets/js/common';\n\nvar user = {\n  state: {\n    user: '',\n    status: '',\n    code: '',\n    token: getToken(),\n    name: '',\n    avatar: '',\n    introduction: '',\n    roles: [],\n    setting: {\n      articlePlatform: []\n    }\n  },\n\n  mutations: { //更改vuex的store中数据状态的唯一方法是提交mutation，mutation类似于一个事件，但不可直接调用\n    SET_CODE: function SET_CODE(state, code) {\n      state.code = code;\n    },\n    SET_TOKEN: function SET_TOKEN(state, token) {\n      state.token = token;\n    },\n    SET_INTRODUCTION: function SET_INTRODUCTION(state, introduction) {\n      state.introduction = introduction;\n    },\n    SET_SETTING: function SET_SETTING(state, setting) {\n      state.setting = setting;\n    },\n    SET_STATUS: function SET_STATUS(state, status) {\n      state.status = status;\n    },\n    SET_NAME: function SET_NAME(state, name) {\n      state.name = name;\n    },\n    SET_AVATAR: function SET_AVATAR(state, avatar) {\n      state.avatar = avatar;\n    },\n    SET_ROLES: function SET_ROLES(state, roles) {\n      state.roles = roles;\n    }\n  },\n\n  //actions：类似于Mutations，不同是的actions提交的是Mutations不是直接改变状态，action可以包含任意异步操作\n  actions: {\n    // 用户名登录\n    LoginByUsername: function LoginByUsername(_ref, userInfo) {\n      var commit = _ref.commit;\n\n      var username = userInfo.username.trim(); //顺便去一下空格\n      return new _Promise(function (resolve, reject) {\n        loginByUsername(username, userInfo.password).then(function (response) {\n          var data = response.data;\n          commit('SET_TOKEN', data.token); //调用commit， 更改mutation中state的值\n          setToken(response.data.token);\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n\n\n    // 获取用户信息\n    GetUserInfo: function GetUserInfo(_ref2) {\n      var commit = _ref2.commit,\n          state = _ref2.state;\n\n      return new _Promise(function (resolve, reject) {\n        getUserInfo(state.token).then(function (response) {\n          if (!response.data) {\n            // 由于mockjs 不支持自定义状态码只能这样hack\n            reject('error');\n          }\n          var data = response.data;\n\n          if (data.roles && data.roles.length > 0) {\n            // 验证返回的roles是否是一个非空数组\n            commit('SET_ROLES', data.roles);\n          } else {\n            reject('getInfo: roles must be a non-null array !');\n          }\n\n          commit('SET_NAME', data.name);\n          commit('SET_AVATAR', data.avatar);\n          commit('SET_INTRODUCTION', data.introduction);\n          resolve(response);\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n\n\n    // 登出\n    LogOut: function LogOut(_ref3) {\n      var commit = _ref3.commit,\n          state = _ref3.state;\n\n      return new _Promise(function (resolve, reject) {\n        logout(state.token).then(function () {\n          commit('SET_TOKEN', '');\n          commit('SET_ROLES', []);\n          removeToken();\n          resolve();\n        }).catch(function (error) {\n          reject(error);\n        });\n      });\n    },\n\n\n    // 前端 登出\n    FedLogOut: function FedLogOut(_ref4) {\n      var commit = _ref4.commit;\n\n      return new _Promise(function (resolve) {\n        commit('SET_TOKEN', '');\n        removeToken();\n        resolve();\n      });\n    },\n\n\n    // 动态修改权限\n    ChangeRoles: function ChangeRoles(_ref5, role) {\n      var commit = _ref5.commit;\n\n      return new _Promise(function (resolve) {\n        commit('SET_TOKEN', role);\n        setToken(role);\n        getUserInfo(role).then(function (response) {\n          var data = response.data;\n          commit('SET_ROLES', data.roles);\n          commit('SET_NAME', data.name);\n          commit('SET_AVATAR', data.avatar);\n          commit('SET_INTRODUCTION', data.introduction);\n          resolve();\n        });\n      });\n    }\n  }\n};\n\nexport default user;",{"version":3,"sources":["src\\store\\modules\\user.js"],"names":["loginByUsername","logout","getUserInfo","getToken","setToken","removeToken","user","state","status","code","token","name","avatar","introduction","roles","setting","articlePlatform","mutations","SET_CODE","SET_TOKEN","SET_INTRODUCTION","SET_SETTING","SET_STATUS","SET_NAME","SET_AVATAR","SET_ROLES","actions","LoginByUsername","userInfo","commit","username","trim","resolve","reject","password","then","data","response","catch","error","GetUserInfo","length","LogOut","FedLogOut","ChangeRoles","role"],"mappings":"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","file":"user.js","sourceRoot":"D:/showU/GGMS","sourcesContent":["import { loginByUsername, logout, getUserInfo } from 'api/login'\r\nimport { getToken, setToken, removeToken } from 'assets/js/common'\r\n\r\nconst user = {\r\n  state: {\r\n    user: '',\r\n    status: '',\r\n    code: '',\r\n    token: getToken(),\r\n    name: '',\r\n    avatar: '',\r\n    introduction: '',\r\n    roles: [],\r\n    setting: {\r\n      articlePlatform: []\r\n    }\r\n  },\r\n\r\n  mutations: {  //更改vuex的store中数据状态的唯一方法是提交mutation，mutation类似于一个事件，但不可直接调用\r\n    SET_CODE: (state, code) => {\r\n      state.code = code\r\n    },\r\n    SET_TOKEN: (state, token) => {\r\n      state.token = token\r\n    },\r\n    SET_INTRODUCTION: (state, introduction) => {\r\n      state.introduction = introduction\r\n    },\r\n    SET_SETTING: (state, setting) => {\r\n      state.setting = setting\r\n    },\r\n    SET_STATUS: (state, status) => {\r\n      state.status = status\r\n    },\r\n    SET_NAME: (state, name) => {\r\n      state.name = name\r\n    },\r\n    SET_AVATAR: (state, avatar) => {\r\n      state.avatar = avatar\r\n    },\r\n    SET_ROLES: (state, roles) => {\r\n      state.roles = roles\r\n    }\r\n  },\r\n  \r\n  //actions：类似于Mutations，不同是的actions提交的是Mutations不是直接改变状态，action可以包含任意异步操作\r\n  actions: {\r\n    // 用户名登录\r\n    LoginByUsername({ commit }, userInfo) {\r\n      const username = userInfo.username.trim() //顺便去一下空格\r\n      return new Promise((resolve, reject) => {\r\n        loginByUsername(username, userInfo.password).then(response => {\r\n          const data = response.data\r\n          commit('SET_TOKEN', data.token)  //调用commit， 更改mutation中state的值\r\n          setToken(response.data.token)\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 获取用户信息\r\n    GetUserInfo({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        getUserInfo(state.token).then(response => {\r\n          if (!response.data) { // 由于mockjs 不支持自定义状态码只能这样hack\r\n            reject('error')\r\n          }\r\n          const data = response.data\r\n\r\n          if (data.roles && data.roles.length > 0) { // 验证返回的roles是否是一个非空数组\r\n            commit('SET_ROLES', data.roles)\r\n          } else {\r\n            reject('getInfo: roles must be a non-null array !')\r\n          }\r\n\r\n          commit('SET_NAME', data.name)\r\n          commit('SET_AVATAR', data.avatar)\r\n          commit('SET_INTRODUCTION', data.introduction)\r\n          resolve(response)\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 登出\r\n    LogOut({ commit, state }) {\r\n      return new Promise((resolve, reject) => {\r\n        logout(state.token).then(() => {\r\n          commit('SET_TOKEN', '')\r\n          commit('SET_ROLES', [])\r\n          removeToken()\r\n          resolve()\r\n        }).catch(error => {\r\n          reject(error)\r\n        })\r\n      })\r\n    },\r\n\r\n    // 前端 登出\r\n    FedLogOut({ commit }) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', '')\r\n        removeToken()\r\n        resolve()\r\n      })\r\n    },\r\n\r\n    // 动态修改权限\r\n    ChangeRoles({ commit }, role) {\r\n      return new Promise(resolve => {\r\n        commit('SET_TOKEN', role)\r\n        setToken(role)\r\n        getUserInfo(role).then(response => {\r\n          const data = response.data\r\n          commit('SET_ROLES', data.roles)\r\n          commit('SET_NAME', data.name)\r\n          commit('SET_AVATAR', data.avatar)\r\n          commit('SET_INTRODUCTION', data.introduction)\r\n          resolve()\r\n        })\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport default user\r\n"]}]}